package tic.tac.toe;

import java.io.IOException;
import java.util.Random;

public class Game {

	public static void RunGame() throws IOException {
		boolean gameType = ConsoleUI.promptForBool("One Player or Two Player (1/2)", "1", "2");
		if (!gameType) {
			twoPlayer();
		} else {
			onePlayer();
		}
	}

	public static void onePlayer() throws IOException {
		String[] options = new String[3];
		options[0] = "1: Easy";
		options[1] = "2: Medium";
		options[2] = "3: Difficult";
		int difficulty = ConsoleUI.promptForMenuSelection(options, false);
		onePlayerSetUp(difficulty);

	}

	public static void onePlayerSetUp(int difficulty) throws IOException {
		boolean Play = false;
		int turns = 0;
		String[] options = new String[1];
		options[0] = "1: Play again";
		boolean player = true;
		Play = false;
		Square Square = new Square();
		Square[][] squares = Board.makeSquares();
		Player User = makePlayer();
		Board.printGameBoard(squares);
		do {
			turns++;
			if (turns > 9) {
				System.out.println("Stalemate");
				Play = true;
			} else if (player == true) {
				User.marker = 'x';
				selectSquare(User, squares, Square);
				Board.printGameBoard(squares);
				Play = JasonsCode(squares, User, Play);
				player = !player;
			} else {
				User.marker = 'o';
				// selectSquare(User, squares, Square);
				if (difficulty == 1) {
					computerSelectSquare(User, squares, Square);
				} else if (difficulty == 2) {
					Random rdm = new Random();
					int selectFromGen = rdm.nextInt(3);
					if (selectFromGen == 0) {
						computerSelectSquare(User, squares, Square);
					} else {
						JasonsAI(User, squares, Square);
					}
				} else {
					JasonsAI(User, squares, Square);
				}
				Board.printGameBoard(squares);
				Play = JasonsCode(squares, User, Play);
				player = !player;
			}
		} while (!Play);
		int UserSelect = ConsoleUI.promptForMenuSelection(options, true);
		if (UserSelect == 1) {
			RunGame();
		} else {
			System.out.println("Quitting");
		}
	}

	public static void JasonsAI(Player X_O, Square[][] squares, Square Set) {
		boolean select = true;
		if ((squares[0][0].SpaceMarker == 'x' && squares[0][2].SpaceMarker == 'x')
				|| (squares[0][0].SpaceMarker == 'o' && squares[0][2].SpaceMarker == 'o')) {// top
																							// (left
																							// &
																							// right)
			squares[0][1].SpaceMarker = 'o';
		} else if ((squares[1][0].SpaceMarker == 'x' && squares[1][2].SpaceMarker == 'x')
				|| (squares[1][0].SpaceMarker == 'o' && squares[1][2].SpaceMarker == 'o')) {// middle
																							// (left
																							// &
																							// right)
			squares[1][1].SpaceMarker = 'o';
		} else if ((squares[2][0].SpaceMarker == 'x' && squares[2][2].SpaceMarker == 'x')
				|| (squares[2][0].SpaceMarker == 'o' && squares[2][2].SpaceMarker == 'o')) {// bottom
																							// (left
																							// &
																							// right)
			squares[2][1].SpaceMarker = 'o';
		} else if ((squares[0][0].SpaceMarker == 'x' && squares[2][0].SpaceMarker == 'x')
				|| (squares[0][0].SpaceMarker == 'o' && squares[2][0].SpaceMarker == 'o')) {// left
																							// (top
																							// &
																							// bottom)
			squares[1][0].SpaceMarker = 'o';
		} else if ((squares[0][1].SpaceMarker == 'x' && squares[2][1].SpaceMarker == 'x')
				|| (squares[0][1].SpaceMarker == 'o' && squares[2][1].SpaceMarker == 'o')) {// middle
																							// (top
																							// &
																							// bottom)
			squares[1][1].SpaceMarker = 'o';
		} else if ((squares[0][2].SpaceMarker == 'x' && squares[2][2].SpaceMarker == 'x')
				|| (squares[0][2].SpaceMarker == 'o' && squares[2][2].SpaceMarker == 'o')) {// right
																							// (top
																							// &
																							// bottom)
			squares[1][2].SpaceMarker = 'o';
		} else if ((squares[0][0].SpaceMarker == 'x' && squares[1][0].SpaceMarker == 'x')
				|| (squares[0][0].SpaceMarker == 'o' && squares[1][0].SpaceMarker == 'o')) {// Left(Top
																							// Two)
			squares[2][0].SpaceMarker = 'o';
		} else if ((squares[0][1].SpaceMarker == 'x' && squares[1][1].SpaceMarker == 'x')
				|| (squares[0][1].SpaceMarker == 'o' && squares[1][1].SpaceMarker == 'o')) {// Middle(Top
																							// Two)
			squares[2][1].SpaceMarker = 'o';
		} else if ((squares[0][2].SpaceMarker == 'x' && squares[1][2].SpaceMarker == 'x')
				|| (squares[0][2].SpaceMarker == 'o' && squares[1][2].SpaceMarker == 'o')) {// Right(Top
																							// Two)
			squares[2][2].SpaceMarker = 'o';
		} else if ((squares[2][0].SpaceMarker == 'x' && squares[1][0].SpaceMarker == 'x')
				|| (squares[2][0].SpaceMarker == 'o' && squares[1][0].SpaceMarker == 'o')) {// Left(Bottom
																							// Two)
			squares[0][0].SpaceMarker = 'o';
		} else if ((squares[2][1].SpaceMarker == 'x' && squares[1][1].SpaceMarker == 'x')
				|| (squares[2][1].SpaceMarker == 'o' && squares[1][1].SpaceMarker == 'o')) {// Middle(Bottom
																							// Two)
			squares[0][1].SpaceMarker = 'o';
		} else if ((squares[2][2].SpaceMarker == 'x' && squares[1][2].SpaceMarker == 'x')
				|| (squares[2][2].SpaceMarker == 'o' && squares[1][2].SpaceMarker == 'o')) {// Right(Bottom
																							// Two)
			squares[0][2].SpaceMarker = 'o';
		} else if ((squares[0][0].SpaceMarker == 'x' && squares[0][1].SpaceMarker == 'x')
				|| (squares[0][0].SpaceMarker == 'o' && squares[0][1].SpaceMarker == 'o')) {// Top(Left
																							// Side)
			squares[0][2].SpaceMarker = 'o';
		} else if ((squares[1][0].SpaceMarker == 'x' && squares[1][1].SpaceMarker == 'x')
				|| (squares[1][0].SpaceMarker == 'o' && squares[1][1].SpaceMarker == 'o')) {// Middle(Left
																							// Side)
			squares[1][2].SpaceMarker = 'o';
		} else if ((squares[2][0].SpaceMarker == 'x' && squares[2][1].SpaceMarker == 'x')
				|| (squares[2][0].SpaceMarker == 'o' && squares[2][1].SpaceMarker == 'o')) {// Bottom(Left
																							// Side)
			squares[2][2].SpaceMarker = 'o';
		} else if ((squares[0][2].SpaceMarker == 'x' && squares[0][1].SpaceMarker == 'x')
				|| (squares[0][2].SpaceMarker == 'o' && squares[0][1].SpaceMarker == 'o')) {// Top(Right
																							// Side)
			squares[0][0].SpaceMarker = 'o';
		} else if ((squares[1][2].SpaceMarker == 'x' && squares[1][1].SpaceMarker == 'x')
				|| (squares[1][2].SpaceMarker == 'o' && squares[1][1].SpaceMarker == 'o')) {// Middle(Right
																							// Side)
			squares[1][0].SpaceMarker = 'o';
		} else if ((squares[2][2].SpaceMarker == 'x' && squares[2][1].SpaceMarker == 'x')
				|| (squares[2][2].SpaceMarker == 'o' && squares[2][1].SpaceMarker == 'o')) {// Bottom(Right
																							// Side)
			squares[2][0].SpaceMarker = 'o';
		} else if ((squares[0][0].SpaceMarker == 'x' && squares[2][2].SpaceMarker == 'x')
				|| (squares[0][0].SpaceMarker == 'o' && squares[2][2].SpaceMarker == 'o')) {// Diagonal(Top
																							// to
																							// Bottom)
			squares[1][1].SpaceMarker = 'o';
		} else if ((squares[2][0].SpaceMarker == 'x' && squares[0][2].SpaceMarker == 'x')
				|| (squares[2][0].SpaceMarker == 'o' && squares[0][2].SpaceMarker == 'o')) {// Diagonal(Bottom
																							// to
																							// Top)
			squares[1][1].SpaceMarker = 'o';
		} else {
			computerSelectSquare(X_O, squares, Set);
			select = false;
		}
		
	}

	private static void computerSelectSquare(Player X_O, Square[][] squares, Square Set) {
		boolean valid = true;
		int selection = 0;
		do {
			valid = true;
			Random rdm = new Random();
			selection = (rdm.nextInt(9) + 1);

			int row = 0;
			int col = 0;

			if (selection == 1) {
				row = 0;
				col = 0;
			} else if (selection == 2) {
				row = 0;
				col = 1;
			} else if (selection == 3) {
				row = 0;
				col = 2;
			} else if (selection == 4) {
				row = 1;
				col = 0;
			} else if (selection == 5) {
				row = 1;
				col = 1;
			} else if (selection == 6) {
				row = 1;
				col = 2;
			} else if (selection == 7) {
				row = 2;
				col = 0;
			} else if (selection == 8) {
				row = 2;
				col = 1;
			} else if (selection == 9) {
				row = 2;
				col = 2;
			}
			if (squares[row][col].SpaceMarker != 'x' && squares[row][col].SpaceMarker != 'o') {
				Set.SpaceMarker = X_O.marker;
				squares[row][col].SpaceMarker = Set.SpaceMarker;
			} else {
				valid = false;
			}
		} while (!valid);
		System.out.println("");

	}

	public static void twoPlayer() throws IOException {
		int turns = 0;
		boolean Play = false;
		String[] options = new String[1];
		options[0] = "1: Play again";
		boolean player = true;
		Play = false;
		Square Square = new Square();
		Square[][] squares = Board.makeSquares();
		Player User = makePlayer();
		Board.printGameBoard(squares);
		do {
			turns++;
			if (turns > 9) {
				System.out.println("Stalemate");
				Play = true;
			} else if (player == true) {
				User.marker = 'x';
				selectSquare(User, squares, Square);
				Board.printGameBoard(squares);
				Play = JasonsCode(squares, User, Play);
				player = !player;
			} else {
				User.marker = 'o';
				selectSquare(User, squares, Square);
				Board.printGameBoard(squares);
				Play = JasonsCode(squares, User, Play);
				player = !player;
			}
		} while (!Play);
		int UserSelect = ConsoleUI.promptForMenuSelection(options, true);
		if (UserSelect == 1) {
			RunGame();
		} else {
			System.out.println("Quitting");
		}
	}

	public static boolean JasonsCode(Square[][] squares, Player Turn, boolean play) {

		if (((squares[0][0].SpaceMarker) == 'x' && (squares[0][1].SpaceMarker) == 'x'
				&& (squares[0][2].SpaceMarker) == 'x')
				|| ((squares[0][0].SpaceMarker) == 'o' && (squares[0][1].SpaceMarker) == 'o'
						&& (squares[0][2].SpaceMarker) == 'o')) {// Top
																	// line
			if ((squares[0][0].SpaceMarker) == 'x') {
				System.out.println("Player X Wins");
				play = true;
			}
			if ((squares[0][0].SpaceMarker) == 'o') {
				System.out.println("Player O Wins");
				play = true;
			}
		}
		if (((squares[0][0].SpaceMarker) == 'x' && (squares[1][0].SpaceMarker) == 'x'
				&& (squares[2][0].SpaceMarker) == 'x')
				|| ((squares[0][0].SpaceMarker) == 'o' && (squares[1][0].SpaceMarker) == 'o'
						&& (squares[2][0].SpaceMarker) == 'o')) {// Left
																	// side
			if ((squares[0][0].SpaceMarker) == 'x') {
				System.out.println("Player X Wins");
				play = true;
			}
			if ((squares[0][0].SpaceMarker) == 'o') {
				System.out.println("Player O Wins");
				play = true;
			}
		}
		if (((squares[2][0].SpaceMarker) == 'x' && (squares[2][1].SpaceMarker) == 'x'
				&& (squares[2][2].SpaceMarker) == 'x')
				|| ((squares[2][0].SpaceMarker) == 'o' && (squares[2][1].SpaceMarker) == 'o'
						&& (squares[2][2].SpaceMarker) == 'o')) {// Bottom
																	// Line
			if ((squares[2][0].SpaceMarker) == 'x') {
				System.out.println("Player X Wins");
				play = true;
			}
			if ((squares[2][0].SpaceMarker) == 'o') {
				System.out.println("Player O Wins");
				play = true;
			}
		}
		if (((squares[0][1].SpaceMarker) == 'x' && (squares[1][1].SpaceMarker) == 'x'
				&& (squares[2][1].SpaceMarker) == 'x')
				|| ((squares[0][1].SpaceMarker) == 'o' && (squares[1][1].SpaceMarker) == 'o'
						&& (squares[2][1].SpaceMarker) == 'o')) {// Middle
																	// Vert.
																	// Line
			if ((squares[0][1].SpaceMarker) == 'x') {
				System.out.println("Player X Wins");
				play = true;
			}
			if ((squares[0][1].SpaceMarker) == 'o') {
				System.out.println("Player O Wins");
				play = true;
			}
		}
		if (((squares[1][0].SpaceMarker) == 'x' && (squares[1][1].SpaceMarker) == 'x'
				&& (squares[1][2].SpaceMarker) == 'x')
				|| ((squares[1][0].SpaceMarker) == 'o' && (squares[1][1].SpaceMarker) == 'o'
						&& (squares[1][2].SpaceMarker) == 'o')) {// Middle
																	// Hort.
																	// Line
			if ((squares[1][0].SpaceMarker) == 'x') {
				System.out.println("Player X Wins");
				play = true;
			}
			if ((squares[1][0].SpaceMarker) == 'o') {
				System.out.println("Player O Wins");
				play = true;
			}
		}
		if (((squares[0][2].SpaceMarker) == 'x' && (squares[1][2].SpaceMarker) == 'x'
				&& (squares[2][2].SpaceMarker) == 'x')
				|| ((squares[0][2].SpaceMarker) == 'o' && (squares[1][2].SpaceMarker) == 'o'
						&& (squares[2][2].SpaceMarker) == 'o')) {// Right
																	// Line
			if ((squares[0][2].SpaceMarker) == 'x') {
				System.out.println("Player X Wins");
				play = true;
			}
			if ((squares[0][2].SpaceMarker) == 'o') {
				System.out.println("Player O Wins");
				play = true;
			}
		}
		if (((squares[0][0].SpaceMarker) == 'x' && (squares[1][1].SpaceMarker) == 'x'
				&& (squares[2][2].SpaceMarker) == 'x')
				|| ((squares[0][0].SpaceMarker) == 'o' && (squares[1][1].SpaceMarker) == 'o'
						&& (squares[2][2].SpaceMarker) == 'o')) {// Top-L--Bottom-R
			if ((squares[0][0].SpaceMarker) == 'x') {
				System.out.println("Player X Wins");
				play = true;
			}
			if ((squares[0][0].SpaceMarker) == 'o') {
				System.out.println("Player O Wins");
				play = true;
			}
		}
		if (((squares[2][0].SpaceMarker) == 'x' && (squares[1][1].SpaceMarker) == 'x'
				&& (squares[0][2].SpaceMarker) == 'x')
				|| ((squares[2][0].SpaceMarker) == 'o' && (squares[1][1].SpaceMarker) == 'o'
						&& (squares[0][2].SpaceMarker) == 'o')) {// Bottom-L--Top-R
			if ((squares[0][2].SpaceMarker) == 'x') {
				System.out.println("Player X Wins");
				play = true;
			}
			if ((squares[0][2].SpaceMarker) == 'o') {
				System.out.println("Player O Wins");
				play = true;
			}
		}
		return play;
	}

	public static void selectSquare(Player X_O, Square[][] squares, Square Set) throws IOException {
		boolean valid = true;
		do {
			valid = true;
			int selection = ConsoleUI.promptForInt("Player " + X_O.marker + " Select Square", 1, 9);

			int row = 0;
			int col = 0;

			if (selection == 1) {
				row = 0;
				col = 0;
			} else if (selection == 2) {
				row = 0;
				col = 1;
			} else if (selection == 3) {
				row = 0;
				col = 2;
			} else if (selection == 4) {
				row = 1;
				col = 0;
			} else if (selection == 5) {
				row = 1;
				col = 1;
			} else if (selection == 6) {
				row = 1;
				col = 2;
			} else if (selection == 7) {
				row = 2;
				col = 0;
			} else if (selection == 8) {
				row = 2;
				col = 1;
			} else if (selection == 9) {
				row = 2;
				col = 2;
			}
			if (squares[row][col].SpaceMarker != 'x' && squares[row][col].SpaceMarker != 'o') {
				Set.SpaceMarker = X_O.marker;
				squares[row][col].SpaceMarker = (Set.SpaceMarker);
			} else {
				System.out.println("Already Taken");
				valid = false;
			}
		} while (!valid);

	}

	public static Player makePlayer() {
		Player x = new Player();
		return x;
	}

}
